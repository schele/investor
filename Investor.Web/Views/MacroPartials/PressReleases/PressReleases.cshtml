@using Investor.Abstraction.Pressreleases
@using StructureMap
@using Umbraco.Web.Macros

@inherits PartialViewMacroPage
              
@{
    var pressReleaseRepository = ObjectFactory.GetInstance<IPressReleaseRepository>();
    var url = Model.MacroParameters["Url"].ToString();
    
    
    //var pressReleaseNode = Model.StartPage
}

<div class="press-releases">
    <div class="press-releases-header">
        @if (Model.MacroParameters["Heading"] != null)
        {
            <h2>
                @if (Model.MacroParameters["Url"] != null)
                {
                    <a href="@Umbraco.TypedContent(url).Url">@(Model.MacroParameters["Heading"].ToString())</a>
                }
            </h2>
          }
    </div>
    <ul class="press-releases-list">
        @foreach (var pressRelease in pressReleaseRepository.GetPressReleases())
        {
            <li>
                @* todo: get pressreleasenode from startpage *@
                <a href="/investors-media/press-releases/?id=@pressRelease.Id">
                    <span class="press-releases-date">@pressRelease.Published.ToString(Umbraco.GetDictionaryValue("DateFormat"))</span>
                    <span class="press-releases-time">@pressRelease.Published.ToString(Umbraco.GetDictionaryValue("TimeFormat"))</span>
                    <span class="press-releases-link-text">@pressRelease.Headline</span>                            
                </a>
            </li>
        }
    </ul>
</div>