@using Investor.Helpers
@using Investor.Models.Models
@using Investor.Models.Models.NodeLink
@using Investor.Models.PageModels

@inherits UmbracoViewPage<BaseModel>

@functions
{        
    private RelatedLink GetRelatedLink(NodeLink node)
    {
        var relatedLink = new RelatedLink();
        
        if (node.Type == "internal")
        {
            relatedLink.Url =  Umbraco.TypedContent(node.Link).Url;
        }

        if (node.Type == "internalMedia")
        {
            relatedLink.Url =  Umbraco.TypedMedia(node.Link).Url;
        }

        if (node.Type == "external")
        { 
            relatedLink.Url = node.Link;
        }

        relatedLink.Caption = node.Caption;
        relatedLink.Target = node.NewWindow ? "_blank" : null;
        
        return relatedLink;
    }
}

<!DOCTYPE html>
<html lang="@Model.CurrentCulture.TwoLetterISOLanguageName" data-culture="@Model.CurrentCulture.Name">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    @if (!string.IsNullOrEmpty(Model.MetaForRobots))
    {
        <meta name="robots" content="@Model.MetaForRobots">
    }

    @if (!string.IsNullOrEmpty(Model.GetMetaDescription()))
    {
        <meta name="description" content="@Model.GetMetaDescription()" />
    }

    @if (!string.IsNullOrEmpty(Model.MetaKeywords))
    {
        <meta name="keywords" content="@Model.MetaKeywords" />
    }

    <link rel="canonical" href="@Umbraco.NiceUrlWithDomain(Model.Id)" />

    <title>@Model.BrowserTabText - Investor AB</title>

    <script>document.domain = document.domain.replace(/[^.]*\./, '');</script>

    <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/favicon/manifest.json">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#002b7e">
    <link rel="shortcut icon" href="/favicon/favicon.ico">

    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/favicon/mstile-144x144.png">
    <meta name="msapplication-config" content="/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Bootstrap core CSS -->
    <link href="~/UI/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="~/static/styles/reset.css" rel="stylesheet"/>
    <link href="~/SASS/magnific-popup.css" rel="stylesheet" />
    <link href="~/static/styles/style.css" rel="stylesheet"/>
    
    <link href="https://fast.fonts.com/cssapi/faceeab9-d987-4e76-a745-579b6a1ab1d8.css" rel="stylesheet" type="text/css" />	

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="~/UI/css/ie10-viewport-bug-workaround.css" rel="stylesheet" />

    @if (!string.IsNullOrEmpty(Model.StartPage.GoogleAnalytics))
    {
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments);
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g;
                m.parentNode.insertBefore(a, m);
            })(window, document, 'script', 'ui/js/analytics.js', 'ga');

            ga('create', '@Model.StartPage.GoogleAnalytics', '@library.RequestServerVariables("SERVER_NAME")');
            ga('send', 'pageview');
        </script>
    }

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
    @*<script type="text/javascript">
    window.cookieconsent_options = { "message": "@Model.StartPage.CookieText", "dismiss": "@Model.StartPage.CookieButtonText", "learnMore": "@Model.StartPage.CookieUrlText", "link": "/cookies", "theme": "light-bottom" };
    </script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>*@
    <!-- End Cookie Consent plugin -->
</head>

<body data-ng-app="baseApp">
    @Html.Partial("~/Views/Partials/Cookies.cshtml")
    @Html.Partial("~/Views/Partials/Header.cshtml")

    <div class="container">
        @RenderBody()
    </div>

    @Html.Partial("~/Views/Partials/Footer.cshtml")

    <a href="" data-mfp-src="#test-popup" id="fancy_box"></a>
    <div id="test-popup" class="campaign-popup mfp-hide">
        <button class="campaign-custom-close" id="campaign-custom-close">@Umbraco.GetDictionaryValue("System.Modal.Close")</button>
        <img class="mobile-image" src="~/images/investor-popup-pattern-mobile-small.png" alt="investor pattern" />
        <img class="logo logo-desktop" src="~/images/investor-popup-logo.png" alt="investor logo" />
        <img class="logo logo-mobile" src="~/images/investor-popup-logo.png" alt="investor logo" />
        @Html.Render(Model.StartPage.PopupText, @<p>@Model.StartPage.PopupText</p>)
        
        @if (Model.StartPage.PopupUrl != null)
        {
            <span>@GetRelatedLink(Model.StartPage.PopupUrl)</span>
        }

        @*  exempel med annat pattern *@
        @*@Html.RelatedLink(Model.StartPage.PopupUrl, @<span>@Model.StartPage.PopupText</span>)*@

        <button class="campaign-custom-close-mobile" id="campaign-custom-close-mobile">Stanna kvar på investorab</button>
    </div>
    <script src="~/Scripts/angular/lib/underscore.js" type="text/javascript"></script>
    <script src="~/Scripts/lib/jquery-1.12.3.min.js" type="text/javascript"></script>
    <script src="~/Scripts/lib/jquery-ui.min.js" type="text/javascript"></script>
    <script src="~/Scripts/lib/jquery.magnific-popup.min.js" type="text/javascript"></script>
    <script src="~/Scripts/mobile-navigation.js" type="text/javascript"></script>
    <script src="~/Scripts/slideshow.js" type="text/javascript"></script>
    <script src="~/Scripts/campaign-lightbox.js" type="text/javascript"></script>
    <script src="~/Scripts/sub-navigation.js" type="text/javascript"></script>
    <script src="//vp053.alertir.com/afw/javascript/shared/iframeresizer/iframeResizer.min.js"></script>
    <script src="~/Scripts/iframe-size.js" type="text/javascript"></script>
    <script src="~/Scripts/list-expand.js" type="text/javascript"></script>
    <script src="~/Scripts/cookies.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/angular.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/angular-sanitize.min.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/angular-route.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/angular-cookies.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/typeahead.bundle.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/lib/angular-typeahead.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/modules/angularConfiguration.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/angularServices.js" type="text/javascript"></script>
    <script src="~/Scripts/angular/angularControllers.js" type="text/javascript"></script>
</body>
</html>